# SPI-Module-with-Testbench

This project is a RTL implementation of the Serial Peripheral Interface module.
This project is written in verilog and is simulated using ModelSim.



## Overview
The Serial Peripheral Interface (SPI) module is a synchronous serial communication interface commonly used in microcontroller systems. It enables high-speed, full-duplex communication between a master device and one or more peripheral devices. SPI operates in a master-slave configuration, where the master device controls the communication timing and data flow.

The working of the SPI module is as follows:

    -The master asserts the chip select of the desired slave device.
    -The clock signal (SCLK) is generated by the master to establish communication timing.
    -The master sends data bits on the MOSI line, and simultaneously, the slave sends data on the MISO line.
    -Data is exchanged bit by bit with each clock pulse.
    -The slave device processes the received data and responds if necessary.
    -Once the communication is complete, the master de-asserts the chip select.
## Code Explanation and Working

### Spi_clock_gen.v

This module generates the clock signal for SPI communication. 

    -It receives inputs wb_clk, reset, and divider, which likely control the frequency of the generated clock.
    -The module outputs the generated clock signal sclk, along with two complementary clock signals cpol0 and cpol1.
    -The module maintains a counter (counter) that controls the frequency of the generated clock.
    -The clock polarity (cpol0 and cpol1) alternates the clock signal (sclk).

### Rx_shift_register.v
This module handles the receiving data from the SPI bus and shifts it into a register.

    -It receives inputs such as reset, char_len, miso, go_busy, clk, and lsb.
    -It outputs the received data as outrxd, signals rx_complete when data reception is complete, and provides a clock signal as clk_out.
    -The module shifts received data into a register (rxreg) based on the specified data length (char_len).
    -The shift direction depends on the lsb (least significant bit) value, where lsb determines whether the least significant bit is received first or last.
    -The data reception is controlled by the go_busy signal.
    -The rx_complete signal is set when the specified data length is received.
    -The count variable is used to keep track of the number of bits received.

### Tx_shift_register.v
This module handles transmitting data to the SPI bus by shifting data out of a register. 

    -It takes inputs such as reset, char_len, intx, mosi, go_busy, clk, and lsb.
    -The module outputs the transmitted data (mosi), a signal indicating transmission completion (tx_complete), and the clock signal (clk_out).
    -The module loads data to be transmitted (intx) into a register (txreg) based on the specified data length (char_len).
    -The data shift direction is determined by the lsb value.
    -Data transmission is initiated by the go_busy signal.
    -The tx_complete signal is asserted when all data bits are transmitted.
    -The count variable tracks the number of bits transmitted.
    -The outtxbuff signal holds the data to be transmitted (mosi).

## Installation

The files can be downloaded and then simulated in verilog. Each internal module (SPI clock and shift registers) has a seperate file along with its testbench. The files and their individual testbenches can be run.
